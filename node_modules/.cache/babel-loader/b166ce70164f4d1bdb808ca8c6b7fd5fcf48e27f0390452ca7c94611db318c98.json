{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Vue from \"vue\";\nimport { Editor, Toolbar } from \"@wangeditor/editor-for-vue\";\nexport default Vue.extend({\n  components: {\n    Editor,\n    Toolbar\n  },\n  data() {\n    return {\n      html: \"\",\n      toolbarConfig: {},\n      editorConfig: {\n        placeholder: \"请输入内容...\",\n        MENU_CONF: {\n          uploadImage: {\n            server: \"http://8.138.10.52:6060//upload\",\n            fieldName: 'file',\n            customInsert(res, insertFn) {\n              console.log(res);\n              insertFn(res.data);\n            }\n          },\n          uploadVideo: {\n            server: \"http://8.138.10.52:6060//upload\",\n            fieldName: 'file',\n            maxFileSize: 200 * 1024 * 1024,\n            customInsert(res, insertFn) {\n              console.log(res);\n              insertFn(res.data);\n            }\n          }\n        }\n      },\n      mode: \"default\",\n      // or 'simple',\n      editor: null,\n      Post: {\n        accountId: null,\n        avatar: null,\n        nickname: null,\n        title: null,\n        text: null,\n        localId: null\n      }\n    };\n  },\n  methods: {\n    onCreated(editor) {\n      this.editor = Object.seal(editor); // 一定要用 Object.seal() ，否则会报错\n    },\n    postAdd() {\n      const accountData = JSON.parse(localStorage.getItem(\"accountData\"));\n      this.Post.accountId = accountData.id;\n      this.Post.avatar = accountData.avatar;\n      this.Post.nickname = accountData.nickname;\n      this.Post.text = this.editor.getHtml();\n      console.log(this.Post);\n      this.request.post(\"/post/publish\", this.Post).then(res => {\n        if (res.code === \"200\") {\n          this.$message.success(\"发布成功\");\n          this.$router.push(\"/user/community\");\n        } else {\n          this.$message.error(\"发布失败\");\n        }\n      });\n    }\n  },\n  mounted() {},\n  beforeDestroy() {\n    const editor = this.editor;\n    if (editor == null) return;\n    editor.destroy(); // 组件销毁时，及时销毁编辑器\n  }\n});","map":{"version":3,"names":["Vue","Editor","Toolbar","extend","components","data","html","toolbarConfig","editorConfig","placeholder","MENU_CONF","uploadImage","server","fieldName","customInsert","res","insertFn","console","log","uploadVideo","maxFileSize","mode","editor","Post","accountId","avatar","nickname","title","text","localId","methods","onCreated","Object","seal","postAdd","accountData","JSON","parse","localStorage","getItem","id","getHtml","request","post","then","code","$message","success","$router","push","error","mounted","beforeDestroy","destroy"],"sources":["src/views/userViews/Community/PostEditing.vue"],"sourcesContent":["<template>\r\n  <div\r\n    style=\"\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      background-color: aliceblue;\r\n    \"\r\n  >\r\n    <div\r\n      style=\"\r\n        display: flex;\r\n        /* align-items: center; */\r\n        justify-content: center;\r\n        flex-direction: column;\r\n        width: 60vw;\r\n        background-color: white;\r\n        margin-top: 20px;\r\n        padding-top: 15px;\r\n        padding-left: 4vw;\r\n        padding-right: 4vw;\r\n      \"\r\n    >\r\n      <!-- 头部 -->\r\n      <div\r\n        class=\"head\"\r\n        style=\"\r\n          display: flex;\r\n          justify-content: space-between;\r\n          border-bottom: 1px solid #ccc;\r\n        \"\r\n      >\r\n        <span style=\"font-size: 20px; font-weight: bold\">发布帖子</span>\r\n        <span>test</span>\r\n      </div>\r\n\r\n      <!-- 主体 -->\r\n      <div class=\"body\">\r\n        <!-- 标题 -->\r\n        <div\r\n          class=\"Title\"\r\n          style=\"\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n            margin-top: 40px;\r\n          \"\r\n        >\r\n          <label for=\"\">标题: </label>\r\n          <el-input\r\n            type=\"text\"\r\n            placeholder=\"标题(必填)\"\r\n            v-model=\"Post.title\"\r\n            maxlength=\"30\"\r\n            show-word-limit\r\n            style=\"width: 90%\"\r\n            size=\"medium\"\r\n          >\r\n          </el-input>\r\n        </div>\r\n\r\n        <!-- 内容 -->\r\n        <div\r\n          class=\"message\"\r\n          style=\"\r\n            margin-top: 40px;\r\n            display: flex;\r\n            justify-content: space-between;\r\n          \"\r\n        >\r\n          <label for=\"\">内容: </label>\r\n          <div style=\"border: 1px solid #ccc; width: 90%\">\r\n            <Toolbar\r\n              style=\"border-bottom: 1px solid #ccc\"\r\n              :editor=\"editor\"\r\n              :defaultConfig=\"toolbarConfig\"\r\n              :mode=\"mode\"\r\n            />\r\n            <Editor\r\n              style=\"height: 60vh; overflow-y: hidden\"\r\n              v-model=\"html\"\r\n              :defaultConfig=\"editorConfig\"\r\n              :mode=\"mode\"\r\n              @onCreated=\"onCreated\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 地区选择 -->\r\n        <div\r\n          class=\"localSelect\"\r\n          style=\"\r\n            margin-top: 40px;\r\n            display: flex;\r\n            justify-content: space-between;\r\n          \"\r\n        >\r\n          <label for=\"\">地区选择: </label>\r\n          <div style=\"display: flex; flex-wrap: wrap; width: 90%\">\r\n            <el-radio v-model=\"Post.localId\" label=\"1\">湘西</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"2\">张家界</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"3\">永顺</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"4\">吉首</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"5\">花垣</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"6\">古丈</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"7\">龙山</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"8\">花坛</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"9\">江口</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"10\">桃源</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"11\">安化</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"12\">凤凰</el-radio>\r\n            <el-radio v-model=\"Post.localId\" label=\"13\">非遗</el-radio>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div\r\n        class=\"foot\"\r\n        style=\"margin-top: 40px; display: flex; justify-content: center\"\r\n      >\r\n        <el-button\r\n          type=\"primary\"\r\n          v-on:click=\"postAdd\"\r\n          style=\"font-size: 17px; font-weight: bold; width: 20%; height: 5vh\"\r\n          >发布帖子</el-button\r\n        >\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from \"vue\";\r\nimport { Editor, Toolbar } from \"@wangeditor/editor-for-vue\";\r\n\r\nexport default Vue.extend({\r\n  components: { Editor, Toolbar },\r\n  data() {\r\n    return {\r\n      html: \"\",\r\n      toolbarConfig: {},\r\n      editorConfig: {\r\n        placeholder: \"请输入内容...\",\r\n        MENU_CONF: {\r\n          uploadImage: {\r\n            server: \"http://8.138.10.52:6060//upload\",\r\n            fieldName: 'file',\r\n            customInsert(res, insertFn){\r\n              console.log(res);\r\n              insertFn(res.data);\r\n            }\r\n          },\r\n\r\n          uploadVideo: {\r\n            server: \"http://8.138.10.52:6060//upload\",\r\n            fieldName: 'file',\r\n            maxFileSize: 200 * 1024 * 1024,\r\n            customInsert(res, insertFn){\r\n              console.log(res);\r\n              insertFn(res.data);\r\n            }\r\n\r\n          }\r\n        },\r\n      },\r\n\r\n      mode: \"default\", // or 'simple',\r\n      editor: null,\r\n      Post: {\r\n        accountId: null,\r\n        avatar: null,\r\n        nickname: null,\r\n        title: null,\r\n        text: null,\r\n        localId: null,\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    onCreated(editor) {\r\n      this.editor = Object.seal(editor); // 一定要用 Object.seal() ，否则会报错\r\n    },\r\n    postAdd() {\r\n      const accountData = JSON.parse(localStorage.getItem(\"accountData\"));\r\n      this.Post.accountId = accountData.id;\r\n      this.Post.avatar = accountData.avatar;\r\n      this.Post.nickname = accountData.nickname;\r\n      this.Post.text = this.editor.getHtml();\r\n      console.log(this.Post);\r\n      this.request.post(\"/post/publish\", this.Post).then((res) => {\r\n        if (res.code === \"200\") {\r\n          this.$message.success(\"发布成功\");\r\n          this.$router.push(\"/user/community\");\r\n        } else {\r\n          this.$message.error(\"发布失败\");\r\n        }\r\n      });\r\n    },\r\n  },\r\n  mounted() {},\r\n  beforeDestroy() {\r\n    const editor = this.editor;\r\n    if (editor == null) return;\r\n    editor.destroy(); // 组件销毁时，及时销毁编辑器\r\n  },\r\n});\r\n</script>\r\n\r\n<style src=\"@wangeditor/editor/dist/css/style.css\"></style>\r\n<style>\r\n</style>\r\n"],"mappings":";AAoIA,OAAAA,GAAA;AACA,SAAAC,MAAA,EAAAC,OAAA;AAEA,eAAAF,GAAA,CAAAG,MAAA;EACAC,UAAA;IAAAH,MAAA;IAAAC;EAAA;EACAG,KAAA;IACA;MACAC,IAAA;MACAC,aAAA;MACAC,YAAA;QACAC,WAAA;QACAC,SAAA;UACAC,WAAA;YACAC,MAAA;YACAC,SAAA;YACAC,aAAAC,GAAA,EAAAC,QAAA;cACAC,OAAA,CAAAC,GAAA,CAAAH,GAAA;cACAC,QAAA,CAAAD,GAAA,CAAAV,IAAA;YACA;UACA;UAEAc,WAAA;YACAP,MAAA;YACAC,SAAA;YACAO,WAAA;YACAN,aAAAC,GAAA,EAAAC,QAAA;cACAC,OAAA,CAAAC,GAAA,CAAAH,GAAA;cACAC,QAAA,CAAAD,GAAA,CAAAV,IAAA;YACA;UAEA;QACA;MACA;MAEAgB,IAAA;MAAA;MACAC,MAAA;MACAC,IAAA;QACAC,SAAA;QACAC,MAAA;QACAC,QAAA;QACAC,KAAA;QACAC,IAAA;QACAC,OAAA;MACA;IACA;EACA;EACAC,OAAA;IACAC,UAAAT,MAAA;MACA,KAAAA,MAAA,GAAAU,MAAA,CAAAC,IAAA,CAAAX,MAAA;IACA;IACAY,QAAA;MACA,MAAAC,WAAA,GAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACA,KAAAhB,IAAA,CAAAC,SAAA,GAAAW,WAAA,CAAAK,EAAA;MACA,KAAAjB,IAAA,CAAAE,MAAA,GAAAU,WAAA,CAAAV,MAAA;MACA,KAAAF,IAAA,CAAAG,QAAA,GAAAS,WAAA,CAAAT,QAAA;MACA,KAAAH,IAAA,CAAAK,IAAA,QAAAN,MAAA,CAAAmB,OAAA;MACAxB,OAAA,CAAAC,GAAA,MAAAK,IAAA;MACA,KAAAmB,OAAA,CAAAC,IAAA,uBAAApB,IAAA,EAAAqB,IAAA,CAAA7B,GAAA;QACA,IAAAA,GAAA,CAAA8B,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACA,KAAAC,OAAA,CAAAC,IAAA;QACA;UACA,KAAAH,QAAA,CAAAI,KAAA;QACA;MACA;IACA;EACA;EACAC,QAAA;EACAC,cAAA;IACA,MAAA9B,MAAA,QAAAA,MAAA;IACA,IAAAA,MAAA;IACAA,MAAA,CAAA+B,OAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}