{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: \"LoginForm\",\n  data() {\n    return {\n      isAgree: false,\n      loading: false,\n      form: {\n        account: \"\",\n        password: \"\"\n      },\n      loginRules: {\n        account: [{\n          required: true,\n          message: \"请输入账户\",\n          trigger: \"blur\"\n        }, {\n          min: 4,\n          max: 10,\n          message: \"长度在 4 到 10 个字符\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          required: true,\n          message: \"请输入密码\",\n          trigger: \"blur\"\n        }, {\n          min: 4,\n          max: 10,\n          message: \"长度在 4 到 10 个字符\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  // login() {\n  //   request.post(\"/account/login\", this.account).then((res) => {\n  //     console.log(res);\n  //     console.log(this.account);\n  //     console.log(res.data.code)\n  //     if (res.data.code === \"200\") {\n  //       // 登录成功，保存token到本地存储\n  //       localStorage.setItem(\n  //           \"userData\",\n  //           JSON.stringify({\n  //             id: res.data.data.id,\n  //             account: res.data.data.account,\n  //             nickname: res.data.data.nickname,\n  //             avatar: res.data.data.avatar,\n  //             identity: res.data.data.identity,\n  //             token: res.data.data.token,\n  //           })\n  //       );\n  //       console.log(localStorage.getItem(\"identity\"));\n  //       if (res.data.data.identity === \"admin\") {\n  //         this.$router.push(\"/manage/home\");\n  //       } else {\n  //         this.$router.push(\"/\");\n  //       }\n  //       this.$message.success(\"登录成功\");\n  //     } else {\n  //       this.$message.error(\"登录失败\");\n  //     }\n  //   });\n  // },\n  methods: {\n    handleLogin() {\n      if (this.isAgree === false) {\n        this.$notify({\n          title: '警告',\n          message: '请先阅读，并同意协议！',\n          type: 'warning'\n        });\n        return;\n      }\n      this.$refs.loginForm.validate().then(() => {\n        this.loading = true;\n        this.request.post(\"/account/login\", this.form).then(res => {\n          //模拟异步请求后台接口 登录操作\n          setTimeout(() => {\n            this.loading = false;\n            if (res) {\n              // console.log(\"abc\", res);\n              // this.$store.commit(\"setInfo\", res);\n              //不暴露管理员密码\n              localStorage.setItem(\"accountData\", JSON.stringify({\n                id: res.data.id,\n                account: res.data.account,\n                nickname: res.data.nickname,\n                avatar: res.data.avatar,\n                identity: res.data.identity,\n                token: res.data.token\n              }));\n              // delete res.data.password\n              // localStorage.setItem(\"accountData\", JSON.stringify(res));\n              this.$router.push(\"/adminLogin/face\");\n              // console.log(res);\n              // localStorage.setItem(\"token\", res.data.token);\n            } else {\n              this.$message.error(\"请再次检查账号或密码是否错误\");\n            }\n          }, 2000);\n        });\n      }).catch(error => {\n        this.loading = false;\n        this.$message({\n          message: \"输入错误！\",\n          type: \"warning\"\n        });\n      });\n    }\n  }\n};","map":{"version":3,"names":["name","data","isAgree","loading","form","account","password","loginRules","required","message","trigger","min","max","methods","handleLogin","$notify","title","type","$refs","loginForm","validate","then","request","post","res","setTimeout","localStorage","setItem","JSON","stringify","id","nickname","avatar","identity","token","$router","push","$message","error","catch"],"sources":["src/components/manageComponents/LoginForm.vue"],"sourcesContent":["<script>\r\nexport default {\r\n  name: \"LoginForm\",\r\n  data() {\r\n    return {\r\n      isAgree: false,\r\n      loading: false,\r\n      form: {\r\n        account: \"\",\r\n        password: \"\",\r\n      },\r\n      loginRules: {\r\n        account: [\r\n          {required: true, message: \"请输入账户\", trigger: \"blur\"},\r\n          {\r\n            min: 4,\r\n            max: 10,\r\n            message: \"长度在 4 到 10 个字符\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        password: [\r\n          {required: true, message: \"请输入密码\", trigger: \"blur\"},\r\n          {\r\n            min: 4,\r\n            max: 10,\r\n            message: \"长度在 4 到 10 个字符\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  // login() {\r\n  //   request.post(\"/account/login\", this.account).then((res) => {\r\n  //     console.log(res);\r\n  //     console.log(this.account);\r\n  //     console.log(res.data.code)\r\n  //     if (res.data.code === \"200\") {\r\n  //       // 登录成功，保存token到本地存储\r\n  //       localStorage.setItem(\r\n  //           \"userData\",\r\n  //           JSON.stringify({\r\n  //             id: res.data.data.id,\r\n  //             account: res.data.data.account,\r\n  //             nickname: res.data.data.nickname,\r\n  //             avatar: res.data.data.avatar,\r\n  //             identity: res.data.data.identity,\r\n  //             token: res.data.data.token,\r\n  //           })\r\n  //       );\r\n  //       console.log(localStorage.getItem(\"identity\"));\r\n  //       if (res.data.data.identity === \"admin\") {\r\n  //         this.$router.push(\"/manage/home\");\r\n  //       } else {\r\n  //         this.$router.push(\"/\");\r\n  //       }\r\n  //       this.$message.success(\"登录成功\");\r\n  //     } else {\r\n  //       this.$message.error(\"登录失败\");\r\n  //     }\r\n  //   });\r\n  // },\r\n  methods: {\r\n    handleLogin() {\r\n      if (this.isAgree === false) {\r\n        this.$notify({\r\n          title: '警告',\r\n          message: '请先阅读，并同意协议！',\r\n          type: 'warning'\r\n        });\r\n        return\r\n      }\r\n      this.$refs.loginForm\r\n          .validate()\r\n          .then(() => {\r\n            this.loading = true;\r\n            this.request.post(\"/account/login\", this.form).then((res) => {\r\n              //模拟异步请求后台接口 登录操作\r\n              setTimeout(() => {\r\n                this.loading = false;\r\n                if (res) {\r\n                  // console.log(\"abc\", res);\r\n                  // this.$store.commit(\"setInfo\", res);\r\n                  //不暴露管理员密码\r\n                  localStorage.setItem(\r\n                      \"accountData\",\r\n                      JSON.stringify({\r\n                        id: res.data.id,\r\n                        account: res.data.account,\r\n                        nickname: res.data.nickname,\r\n                        avatar: res.data.avatar,\r\n                        identity: res.data.identity,\r\n                        token: res.data.token,\r\n                      })\r\n                  );\r\n                  // delete res.data.password\r\n                  // localStorage.setItem(\"accountData\", JSON.stringify(res));\r\n                  this.$router.push(\"/adminLogin/face\");\r\n                  // console.log(res);\r\n                  // localStorage.setItem(\"token\", res.data.token);\r\n\r\n                } else {\r\n                  this.$message.error(\"请再次检查账号或密码是否错误\");\r\n                }\r\n              }, 2000);\r\n            });\r\n          })\r\n          .catch((error) => {\r\n            this.loading = false;\r\n            this.$message({\r\n              message: \"输入错误！\",\r\n              type: \"warning\",\r\n            });\r\n          });\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<template>\r\n\r\n  <div class=\"login-form\">\r\n    <el-form :model=\"form\" :rules=\"loginRules\" ref=\"loginForm\">\r\n      <el-form-item prop=\"account\">\r\n        <el-input\r\n            type=\"text\"\r\n            v-model=\"form.account\"\r\n            auto-complete=\"off\"\r\n            placeholder=\"请输入用户名\"\r\n        >\r\n          <template slot=\"prepend\"\r\n          ><i style=\"font-size: 20px\" class=\"el-icon-user\"></i\r\n          ></template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item prop=\"password\">\r\n        <el-input\r\n            type=\"password\"\r\n            v-model=\"form.password\"\r\n            auto-complete=\"off\"\r\n            placeholder=\"请输入密码\"\r\n        >\r\n          <template slot=\"prepend\"\r\n          ><i style=\"font-size: 20px\" class=\"el-icon-key\"></i\r\n          ></template>\r\n        </el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item style=\"display: flex; justify-content: center\">\r\n        <el-button type=\"primary\" @click=\"handleLogin\" :loading=\"loading\"\r\n        >登录\r\n        </el-button\r\n        >\r\n        <!--            :disabled=\"disabled\"-->\r\n        <el-tooltip content=\"管理员账号由内部提供\" placement=\"top\" effect=\"light\">\r\n\r\n          <el-button type=\"warning\" disabled>注册</el-button>\r\n        </el-tooltip>\r\n      </el-form-item>\r\n    </el-form>\r\n    <el-checkbox v-model=\"isAgree\">同意<a href=\"#\">《政策协议》</a></el-checkbox>\r\n    <!--    <div class=\"card-footer\">-->\r\n\r\n    <!--    </div>-->\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"],"mappings":";AACA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,OAAA;MACAC,IAAA;QACAC,OAAA;QACAC,QAAA;MACA;MACAC,UAAA;QACAF,OAAA,GACA;UAAAG,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UACAC,GAAA;UACAC,GAAA;UACAH,OAAA;UACAC,OAAA;QACA,EACA;QACAJ,QAAA,GACA;UAAAE,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UACAC,GAAA;UACAC,GAAA;UACAH,OAAA;UACAC,OAAA;QACA;MAEA;IACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACAG,OAAA;IACAC,YAAA;MACA,SAAAZ,OAAA;QACA,KAAAa,OAAA;UACAC,KAAA;UACAP,OAAA;UACAQ,IAAA;QACA;QACA;MACA;MACA,KAAAC,KAAA,CAAAC,SAAA,CACAC,QAAA,GACAC,IAAA;QACA,KAAAlB,OAAA;QACA,KAAAmB,OAAA,CAAAC,IAAA,wBAAAnB,IAAA,EAAAiB,IAAA,CAAAG,GAAA;UACA;UACAC,UAAA;YACA,KAAAtB,OAAA;YACA,IAAAqB,GAAA;cACA;cACA;cACA;cACAE,YAAA,CAAAC,OAAA,CACA,eACAC,IAAA,CAAAC,SAAA;gBACAC,EAAA,EAAAN,GAAA,CAAAvB,IAAA,CAAA6B,EAAA;gBACAzB,OAAA,EAAAmB,GAAA,CAAAvB,IAAA,CAAAI,OAAA;gBACA0B,QAAA,EAAAP,GAAA,CAAAvB,IAAA,CAAA8B,QAAA;gBACAC,MAAA,EAAAR,GAAA,CAAAvB,IAAA,CAAA+B,MAAA;gBACAC,QAAA,EAAAT,GAAA,CAAAvB,IAAA,CAAAgC,QAAA;gBACAC,KAAA,EAAAV,GAAA,CAAAvB,IAAA,CAAAiC;cACA,EACA;cACA;cACA;cACA,KAAAC,OAAA,CAAAC,IAAA;cACA;cACA;YAEA;cACA,KAAAC,QAAA,CAAAC,KAAA;YACA;UACA;QACA;MACA,GACAC,KAAA,CAAAD,KAAA;QACA,KAAAnC,OAAA;QACA,KAAAkC,QAAA;UACA5B,OAAA;UACAQ,IAAA;QACA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}