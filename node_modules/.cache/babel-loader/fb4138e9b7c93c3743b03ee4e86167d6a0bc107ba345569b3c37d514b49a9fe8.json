{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: \"Community\",\n  data() {\n    return {\n      postList: null,\n      popularRecommendList: null,\n      accountData: null,\n      article: {\n        lastArticle: [],\n        hotArticle: []\n      },\n      imgArr: [require(\"./image/1.jpg\"), require(\"./image/2.jpg\"), require(\"./image/3.jpg\"), require(\"./image/4.jpg\")]\n    };\n  },\n  methods: {\n    pageInit() {\n      this.request.post(\"/post/selectAllPosts\").then(res => {\n        this.postList = res.data.reverse();\n      });\n      // this.request.get(\"/post/hot\").then(res => {\n      //   this.article.hotArticle = res.data;\n      // });\n      // this.request.get(\"/post/last\").then(res => {\n      //   this.article.lastArticle = res.data;\n      // });\n    },\n    postAdd() {\n      this.$router.push(\"/user/postEditing\");\n    },\n    postInto(postId) {\n      // window.open(`/post/${postId}`, '_blank');\n      if (this.$route.name === \"帖子详情\") {\n        this.$router.push(\"/user/home\");\n        setTimeout(() => {\n          this.$router.push({\n            name: \"帖子详情\",\n            params: {\n              postId\n            }\n          });\n        }, 1);\n      } else {\n        this.$router.push({\n          name: \"帖子详情\",\n          params: {\n            postId\n          }\n        });\n      }\n    },\n    getSummary(text) {\n      const maxLength = 100; // 设置摘要的最大长度\n      if (text.length <= maxLength) {\n        return text;\n      } else {\n        return text.slice(0, maxLength) + \"\\n......\"; //截断后的文本加省略号\n      }\n    },\n    popularRecommend() {\n      this.request.post(\"/mahout/postRecommend\", this.accountData.id).then(res => {\n        this.popularRecommendList = res.data;\n      });\n    },\n    extractImages(htmlContent) {\n      const regex = /<img[^>]*src=[\"']([^\"']*)[\"'][^>]*>/gi;\n      let match;\n      let images = [];\n      while ((match = regex.exec(htmlContent)) !== null) {\n        // match[1] 包含src属性的值\n        images.push(match[1]);\n      }\n      return images;\n    },\n    changeBatch() {\n      this.popularRecommend();\n    },\n    isFollow(post) {\n      post.follow = !post.follow;\n      const followAccountData = {\n        accountId: this.accountData.id,\n        followAccountId: post.accountId\n      };\n      if (post.follow) {\n        this.request.post(\"/followAccount/followAccountAdd\", followAccountData).then(res => {});\n      } else {\n        this.request.post(\"/followAccount/followAccountDelete\", followAccountData).then(res => {});\n      }\n    }\n  },\n  mounted() {\n    this.pageInit();\n    this.accountData = JSON.parse(localStorage.getItem(\"accountData\"));\n    this.request.post(\"/post/selectAllPosts\", this.accountData.id).then(res => {\n      this.postList = res.data.reverse();\n      console.log(this.postList);\n    });\n    this.popularRecommend();\n  }\n};","map":{"version":3,"names":["name","data","postList","popularRecommendList","accountData","article","lastArticle","hotArticle","imgArr","require","methods","pageInit","request","post","then","res","reverse","postAdd","$router","push","postInto","postId","$route","setTimeout","params","getSummary","text","maxLength","length","slice","popularRecommend","id","extractImages","htmlContent","regex","match","images","exec","changeBatch","isFollow","follow","followAccountData","accountId","followAccountId","mounted","JSON","parse","localStorage","getItem","console","log"],"sources":["src/views/userViews/Community/Community.vue"],"sourcesContent":["<template>\r\n  <div\r\n      style=\"display: flex; justify-content: center; background-color: aliceblue\"\r\n  >\r\n    <div style=\"width: 1000px; display: flex\">\r\n      <div class=\"PageLeft\">\r\n        <!-- 轮播图 -->\r\n        <div style=\"\">\r\n          <el-carousel :interval=\"5000\" arrow=\"always\">\r\n            <el-carousel-item v-for=\"item in imgArr\" :key=\"item\">\r\n              <img\r\n                  :src=\"item\"\r\n                  :alt=\"item\"\r\n                  class=\"carousel-img\"\r\n                  style=\"object-fit: cover\"\r\n              />\r\n            </el-carousel-item>\r\n          </el-carousel>\r\n        </div>\r\n\r\n        <!-- 文章 -->\r\n        <div class=\"Posts\" style=\"display: flex; flex-direction: column\">\r\n          <div\r\n              v-for=\"post in postList\"\r\n              :key=\"post.postId\"\r\n              style=\"\r\n              min-height: 260px;\r\n              height: auto;\r\n              padding-left: 2%;\r\n              padding-right: 2%;\r\n            \"\r\n          >\r\n            <div\r\n                class=\"PostHead\"\r\n                style=\"display: flex; justify-content: space-around; height: 15%\"\r\n            >\r\n              <div class=\"Author\" style=\"display: flex; align-items: center\">\r\n                <span>\r\n                  <el-avatar :size=\"35\" :src=\"post.avatar\"> </el-avatar>\r\n                </span>\r\n                <div style=\"margin-top: 0px; min-width: 20%; width: auto\">\r\n                  <span style=\"font-size: 13px; width: 100%\">{{\r\n                      post.nickname\r\n                    }}</span>\r\n                </div>\r\n\r\n                <div\r\n                    style=\"\r\n                    display: flex;\r\n                    margin-top: 0px;\r\n                    margin-left: 10px;\r\n                    align-items: center;\r\n                    font-size: 13px;\r\n                    color: #ccc;\r\n                  \"\r\n                >\r\n                  {{ post.time }}\r\n                </div>\r\n                <span\r\n                    v-if=\"\r\n                    post.likeCount > 999 ||\r\n                    post.commentCount > 999 ||\r\n                    post.collectCount > 999\r\n                  \"\r\n                ><img\r\n                    src=\"\"\r\n                    class=\"iconfont icon-remen\"\r\n                    style=\"color: #cccccc; font-size: 20px\"\r\n                /></span>\r\n              </div>\r\n\r\n              <div\r\n                  class=\"Follow\"\r\n                  style=\"\r\n                  display: flex;\r\n                  justify-content: flex-end;\r\n                  align-items: center;\r\n                \"\r\n                  v-if=\"accountData.id != post.accountId\"\r\n              >\r\n                <el-button\r\n                    type=\"primary\"\r\n                    :class=\"{\r\n                    FollowButton: post.follow,\r\n                    noFollowButton: !post.follow,\r\n                  }\"\r\n                    style=\"\r\n                    width: 70px;\r\n                    height: 26px;\r\n                    display: flex;\r\n                    justify-content: center;\r\n                    align-items: center;\r\n                    border: 0px;\r\n                  \"\r\n                    v-on:click=\"isFollow(post)\"\r\n                    round\r\n                >{{ post.follow ? \"已关注\" : \"关注\" }}\r\n                </el-button\r\n                >\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"PostMessage\" v-on:click=\"postInto(post.postId)\">\r\n              <div class=\"PostTitle\" style=\"height: 15%\">\r\n                <h3 style=\"border-bottom: 1px solid #ccc\">{{ post.title }}</h3>\r\n              </div>\r\n              <div class=\"PostText\" v-html=\"getSummary(post.text)\"></div>\r\n\r\n              <div class=\"img-box\" style=\"max-height: 100px\">\r\n                <img\r\n                    style=\"width: 100px; height: 100px; margin: 8px\"\r\n                    v-for=\"img in extractImages(post.text).splice(0, 4)\"\r\n                    :key=\"img\"\r\n                    :src=\"img\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"PostBottom\" style=\"margin-top: 0px\">\r\n              <div\r\n                  style=\"\r\n                  width: 30%;\r\n                  display: flex;\r\n                  justify-content: space-around;\r\n                  margin-top: 0px;\r\n                \"\r\n              >\r\n                <div class=\"LikeCount\" style=\"margin-top: 0px\">\r\n                  <img\r\n                      src=\"\"\r\n                      class=\"iconfont icon-dianzan\"\r\n                      style=\"font-size: 20px\"\r\n                  />\r\n                  <span v-if=\"post.likeCount < 999\" style=\"font-size: 14px\">{{\r\n                      post.likeCount\r\n                    }}</span>\r\n                  <span v-else style=\"font-size: 14px\">999+</span>\r\n                </div>\r\n\r\n                <div class=\"CommentCount\" style=\"margin-top: 0px\">\r\n                  <img\r\n                      src=\"\"\r\n                      class=\"el-icon-chat-line-round\"\r\n                      style=\"font-size: 20px\"\r\n                  />\r\n                  <span\r\n                      v-if=\"post.commentCount <= 999\"\r\n                      style=\"font-size: 14px\"\r\n                  >{{ post.commentCount }}</span\r\n                  >\r\n                  <span v-else style=\"font-size: 14px\">999+</span>\r\n                </div>\r\n\r\n                <div class=\"CollectCount\" style=\"margin-top: 0px\">\r\n                  <img\r\n                      src=\"\"\r\n                      class=\"el-icon-star-off\"\r\n                      style=\"font-size: 20px\"\r\n                  />\r\n                  <span\r\n                      v-if=\"post.collectCount <= 999\"\r\n                      style=\"font-size: 14px\"\r\n                  >{{ post.collectCount }}</span\r\n                  >\r\n                  <span v-else style=\"font-size: 14px\">999+</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div\r\n          class=\"PageRight\"\r\n          style=\"width: 20vw; display: flex; flex-direction: column\"\r\n      >\r\n        <div\r\n            style=\"\r\n            align-items: center;\r\n            justify-content: center;\r\n            flex-direction: column;\r\n            display: flex;\r\n          \"\r\n        >\r\n          <div\r\n              style=\"\r\n              display: flex;\r\n              align-items: center;\r\n              flex-direction: column;\r\n              margin-top: 0px;\r\n            \"\r\n          >\r\n            <el-button\r\n                type=\"primary\"\r\n                class=\"btn-carousel-R\"\r\n                v-on:click=\"postAdd\"\r\n            >\r\n              <i class=\"el-icon-edit\" style=\"margin-right: 20%\"></i>\r\n              发布帖子\r\n              <i class=\"el-icon-arrow-right\" style=\"margin-left: 20%\"></i>\r\n            </el-button>\r\n\r\n            <!-- 这个不动，动了对齐不了 -->\r\n            <span></span>\r\n\r\n            <el-button type=\"primary\" class=\"btn-carousel-R\">\r\n              <i class=\"el-icon-picture-outline\" style=\"margin-right: 20%\"></i>\r\n              发布图片\r\n              <i class=\"el-icon-arrow-right\" style=\"margin-left: 20%\"></i>\r\n            </el-button>\r\n          </div>\r\n        </div>\r\n\r\n        <div style=\"height: 270px; display: flex; flex-direction: column\">\r\n          <div class=\"Border-Head-Right\">\r\n            <h4>推荐话题</h4>\r\n            <span\r\n                class=\"ChangeBatch\"\r\n                style=\"color: darkgray; font-size: 14px\"\r\n                v-on:click=\"changeBatch\"\r\n            >换一批</span\r\n            >\r\n          </div>\r\n\r\n          <div style=\"display: flex; flex-direction: column; margin-top: 0px\">\r\n            <div\r\n                v-for=\"recommendPost in popularRecommendList\"\r\n                :key=\"recommendPost.postId\"\r\n                style=\"\r\n                display: flex;\r\n                justify-content: center;\r\n                align-items: stretch;\r\n              \"\r\n            >\r\n              <div style=\"margin-top: 3px; width: 80%; display: flex\">\r\n                <div\r\n                    class=\"PopularRecommend\"\r\n                    style=\"margin-top: 0px; flex-direction: row\"\r\n                    v-on:click=\"postInto(recommendPost.postId)\"\r\n                >\r\n                  <el-tag\r\n                      style=\"\r\n                      height: 20px;\r\n                      display: flex;\r\n                      justify-content: center;\r\n                      align-items: center;\r\n                    \"\r\n                  ><span style=\"font-size: 12px\">话题</span></el-tag\r\n                  >\r\n                  <div style=\"margin-top: 0px; margin-left: 5px\">\r\n                    {{ recommendPost.title }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div style=\"height: 30vh\">\r\n          <div class=\"Border-Head-Right\">\r\n            <h4>官方资讯</h4>\r\n            <span style=\"color: darkgray; font-size: 14px\">更多</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div style=\"height: 300px\">\r\n          <div class=\"Border-Head-Right\">\r\n            <h4>推荐用户</h4>\r\n            <span style=\"color: darkgray; font-size: 14px\">换一批</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Community\",\r\n  data() {\r\n    return {\r\n      postList: null,\r\n      popularRecommendList: null,\r\n      accountData: null,\r\n      article: {\r\n        lastArticle: [],\r\n        hotArticle: [],\r\n      },\r\n      imgArr: [\r\n        require(\"./image/1.jpg\"),\r\n        require(\"./image/2.jpg\"),\r\n        require(\"./image/3.jpg\"),\r\n        require(\"./image/4.jpg\"),\r\n      ],\r\n    };\r\n  },\r\n  methods: {\r\n    pageInit() {\r\n      this.request.post(\"/post/selectAllPosts\").then((res) => {\r\n        this.postList = res.data.reverse();\r\n      });\r\n      // this.request.get(\"/post/hot\").then(res => {\r\n      //   this.article.hotArticle = res.data;\r\n      // });\r\n      // this.request.get(\"/post/last\").then(res => {\r\n      //   this.article.lastArticle = res.data;\r\n      // });\r\n    },\r\n    postAdd() {\r\n      this.$router.push(\"/user/postEditing\");\r\n    },\r\n    postInto(postId) {\r\n      // window.open(`/post/${postId}`, '_blank');\r\n      if (this.$route.name === \"帖子详情\") {\r\n        this.$router.push(\"/user/home\");\r\n        setTimeout(() => {\r\n          this.$router.push({name: \"帖子详情\", params: {postId}});\r\n        }, 1);\r\n      } else {\r\n        this.$router.push({name: \"帖子详情\", params: {postId}});\r\n      }\r\n    },\r\n\r\n    getSummary(text) {\r\n      const maxLength = 100; // 设置摘要的最大长度\r\n      if (text.length <= maxLength) {\r\n        return text;\r\n      } else {\r\n        return text.slice(0, maxLength) + \"\\n......\"; //截断后的文本加省略号\r\n      }\r\n    },\r\n\r\n    popularRecommend() {\r\n      this.request\r\n          .post(\"/mahout/postRecommend\", this.accountData.id)\r\n          .then((res) => {\r\n            this.popularRecommendList = res.data;\r\n          });\r\n    },\r\n    extractImages(htmlContent) {\r\n      const regex = /<img[^>]*src=[\"']([^\"']*)[\"'][^>]*>/gi;\r\n      let match;\r\n      let images = [];\r\n      while ((match = regex.exec(htmlContent)) !== null) {\r\n        // match[1] 包含src属性的值\r\n        images.push(match[1]);\r\n      }\r\n      return images;\r\n    },\r\n\r\n    changeBatch() {\r\n      this.popularRecommend();\r\n    },\r\n\r\n    isFollow(post) {\r\n      post.follow = !post.follow;\r\n      const followAccountData = {\r\n        accountId: this.accountData.id,\r\n        followAccountId: post.accountId,\r\n      };\r\n      if (post.follow) {\r\n        this.request\r\n            .post(\"/followAccount/followAccountAdd\", followAccountData)\r\n            .then((res) => {\r\n            });\r\n      } else {\r\n        this.request\r\n            .post(\"/followAccount/followAccountDelete\", followAccountData)\r\n            .then((res) => {\r\n            });\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.pageInit();\r\n\r\n    this.accountData = JSON.parse(localStorage.getItem(\"accountData\"));\r\n    this.request.post(\"/post/selectAllPosts\", this.accountData.id).then((res) => {\r\n      this.postList = res.data.reverse();\r\n      console.log(this.postList)\r\n    });\r\n\r\n    this.popularRecommend();\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n/* 右侧 */\r\n.btn-carousel-R {\r\n  font-size: 15px !important;\r\n  width: 200px;\r\n  /* height: 20%; */\r\n  margin-top: 20px;\r\n  margin-bottom: 20px;\r\n  font-weight: bold;\r\n}\r\n\r\n.PageRight div {\r\n  margin-top: 15px;\r\n  width: 100%;\r\n  background-color: white;\r\n  display: flex;\r\n}\r\n\r\n.Border-Head-Right {\r\n  height: 30px;\r\n  display: flex;\r\n  justify-content: space-around;\r\n  border-bottom: 1px solid #e7e5e5;\r\n}\r\n\r\n/* 左侧 */\r\n.PageLeft {\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  flex-direction: column;\r\n  margin-right: 10px;\r\n  width: 68%;\r\n}\r\n\r\n.PageLeft .Posts div {\r\n  width: 100%;\r\n  margin-top: 10px;\r\n  background-color: white;\r\n}\r\n\r\n.ChangeBatch:hover {\r\n  cursor: pointer;\r\n}\r\n\r\n.PopularRecommend {\r\n  cursor: pointer;\r\n}\r\n\r\n.FollowButton {\r\n  font-size: 14px !important;\r\n  background-color: #f5f5f5 !important;\r\n  color: #999 !important;\r\n}\r\n\r\n.noFollowButton {\r\n  font-size: 14px !important;\r\n  background-color: #00c3ff !important;\r\n  color: white !important;\r\n}\r\n\r\n/* 帖子 */\r\n.Post {\r\n  display: flex;\r\n}\r\n\r\n.PostMessage {\r\n  min-height: 60%;\r\n  height: auto;\r\n}\r\n\r\n.PostBottom {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.Author :hover {\r\n  color: blue;\r\n  cursor: pointer;\r\n}\r\n\r\n.PostMessage:hover {\r\n  cursor: pointer;\r\n}\r\n\r\n.router-link-active {\r\n  text-decoration: none; /* 去掉下划线 */\r\n  color: inherit; /* 继承父元素颜色 */\r\n}\r\n\r\n.router-link-active:visited {\r\n  color: inherit; /* 设置点击后的颜色为继承父元素颜色，保持不变 */\r\n}\r\n\r\na {\r\n  text-decoration: none; /* 去掉下划线 */\r\n  color: inherit; /* 继承父元素颜色 */\r\n}\r\n\r\na:visited {\r\n  color: inherit; /* 设置点击后的颜色为继承父元素颜色，保持不变 */\r\n}\r\n\r\n/* 其他 */\r\n.icon-like {\r\n  display: inline-block;\r\n  width: 18px;\r\n  height: 18px;\r\n  /* background-image: url(\"@/assets/like1.png\"); */\r\n  background-size: cover;\r\n  margin-right: 10px;\r\n  cursor: pointer;\r\n}\r\n\r\n.icon-collect {\r\n  display: inline-block;\r\n  width: 18px;\r\n  height: 18px;\r\n  /* background-image: url(\"@/assets/collect1.png\"); */\r\n  background-size: cover;\r\n  margin-right: 10px;\r\n  cursor: pointer;\r\n}\r\n\r\n.el-carousel__item h3 {\r\n  color: #475669;\r\n  font-size: 18px;\r\n  opacity: 0.75;\r\n  line-height: 300px;\r\n  margin: 0;\r\n}\r\n\r\n.el-carousel__item:nth-child(2n) {\r\n  background-color: #99a9bf;\r\n}\r\n\r\n.el-carousel__item:nth-child(2n + 1) {\r\n  background-color: #d3dce6;\r\n}\r\n</style>\r\n"],"mappings":";AAqRA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,QAAA;MACAC,oBAAA;MACAC,WAAA;MACAC,OAAA;QACAC,WAAA;QACAC,UAAA;MACA;MACAC,MAAA,GACAC,OAAA,mBACAA,OAAA,mBACAA,OAAA,mBACAA,OAAA;IAEA;EACA;EACAC,OAAA;IACAC,SAAA;MACA,KAAAC,OAAA,CAAAC,IAAA,yBAAAC,IAAA,CAAAC,GAAA;QACA,KAAAb,QAAA,GAAAa,GAAA,CAAAd,IAAA,CAAAe,OAAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC,QAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;IACA;IACAC,SAAAC,MAAA;MACA;MACA,SAAAC,MAAA,CAAAtB,IAAA;QACA,KAAAkB,OAAA,CAAAC,IAAA;QACAI,UAAA;UACA,KAAAL,OAAA,CAAAC,IAAA;YAAAnB,IAAA;YAAAwB,MAAA;cAAAH;YAAA;UAAA;QACA;MACA;QACA,KAAAH,OAAA,CAAAC,IAAA;UAAAnB,IAAA;UAAAwB,MAAA;YAAAH;UAAA;QAAA;MACA;IACA;IAEAI,WAAAC,IAAA;MACA,MAAAC,SAAA;MACA,IAAAD,IAAA,CAAAE,MAAA,IAAAD,SAAA;QACA,OAAAD,IAAA;MACA;QACA,OAAAA,IAAA,CAAAG,KAAA,IAAAF,SAAA;MACA;IACA;IAEAG,iBAAA;MACA,KAAAlB,OAAA,CACAC,IAAA,+BAAAT,WAAA,CAAA2B,EAAA,EACAjB,IAAA,CAAAC,GAAA;QACA,KAAAZ,oBAAA,GAAAY,GAAA,CAAAd,IAAA;MACA;IACA;IACA+B,cAAAC,WAAA;MACA,MAAAC,KAAA;MACA,IAAAC,KAAA;MACA,IAAAC,MAAA;MACA,QAAAD,KAAA,GAAAD,KAAA,CAAAG,IAAA,CAAAJ,WAAA;QACA;QACAG,MAAA,CAAAjB,IAAA,CAAAgB,KAAA;MACA;MACA,OAAAC,MAAA;IACA;IAEAE,YAAA;MACA,KAAAR,gBAAA;IACA;IAEAS,SAAA1B,IAAA;MACAA,IAAA,CAAA2B,MAAA,IAAA3B,IAAA,CAAA2B,MAAA;MACA,MAAAC,iBAAA;QACAC,SAAA,OAAAtC,WAAA,CAAA2B,EAAA;QACAY,eAAA,EAAA9B,IAAA,CAAA6B;MACA;MACA,IAAA7B,IAAA,CAAA2B,MAAA;QACA,KAAA5B,OAAA,CACAC,IAAA,oCAAA4B,iBAAA,EACA3B,IAAA,CAAAC,GAAA,KACA;MACA;QACA,KAAAH,OAAA,CACAC,IAAA,uCAAA4B,iBAAA,EACA3B,IAAA,CAAAC,GAAA,KACA;MACA;IACA;EACA;EACA6B,QAAA;IACA,KAAAjC,QAAA;IAEA,KAAAP,WAAA,GAAAyC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;IACA,KAAApC,OAAA,CAAAC,IAAA,8BAAAT,WAAA,CAAA2B,EAAA,EAAAjB,IAAA,CAAAC,GAAA;MACA,KAAAb,QAAA,GAAAa,GAAA,CAAAd,IAAA,CAAAe,OAAA;MACAiC,OAAA,CAAAC,GAAA,MAAAhD,QAAA;IACA;IAEA,KAAA4B,gBAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}